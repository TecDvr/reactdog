{"ast":null,"code":"import { __assign, __awaiter, __generator } from \"tslib\";\nimport { noop } from './utils';\nexport var SPEC_ENDPOINTS = {\n  internalMonitoringEndpoint: 'https://monitoring-intake.com/abcde?foo=bar',\n  logsEndpoint: 'https://logs-intake.com/abcde?foo=bar',\n  rumEndpoint: 'https://rum-intake.com/abcde?foo=bar',\n  traceEndpoint: 'https://trace-intake.com/abcde?foo=bar'\n};\nexport function isSafari() {\n  return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n}\nexport function isFirefox() {\n  return navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n}\nexport function isIE() {\n  return navigator.userAgent.indexOf('MSIE ') > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./);\n}\nexport function clearAllCookies() {\n  document.cookie.split(';').forEach(function (c) {\n    document.cookie = c.replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n  });\n}\n\nvar FetchStubBuilder =\n/** @class */\nfunction () {\n  function FetchStubBuilder(_a) {\n    var _this = this;\n\n    var requestStartObservable = _a[0],\n        requestCompleteObservable = _a[1];\n    this.requests = [];\n    this.whenAllCompleteFn = noop;\n    var pendingFetch = 0;\n    requestStartObservable.subscribe(function () {\n      pendingFetch += 1;\n    });\n    requestCompleteObservable.subscribe(function (request) {\n      _this.requests.push(request);\n\n      pendingFetch -= 1;\n\n      if (pendingFetch === 0) {\n        // ensure that AssertionError are not swallowed by promise context\n        setTimeout(function () {\n          _this.whenAllCompleteFn(_this.requests);\n        });\n      }\n    });\n  }\n\n  FetchStubBuilder.prototype.whenAllComplete = function (onCompleteFn) {\n    this.whenAllCompleteFn = onCompleteFn;\n  };\n\n  FetchStubBuilder.prototype.getStub = function () {\n    var _this = this;\n\n    return function () {\n      var resolve;\n      var reject;\n      var promise = new Promise(function (res, rej) {\n        resolve = res;\n        reject = rej;\n      });\n\n      promise.resolveWith = function (response) {\n        return __awaiter(_this, void 0, void 0, function () {\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            , resolve(__assign(__assign({}, response), {\n              clone: function () {\n                var cloned = {\n                  text: function () {\n                    return __awaiter(_this, void 0, void 0, function () {\n                      return __generator(this, function (_a) {\n                        if (response.responseTextError) {\n                          throw response.responseTextError;\n                        }\n\n                        return [2\n                        /*return*/\n                        , response.responseText];\n                      });\n                    });\n                  }\n                };\n                return cloned;\n              }\n            }))];\n          });\n        });\n      };\n\n      promise.rejectWith = function (error) {\n        return __awaiter(_this, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            , reject(error)];\n          });\n        });\n      };\n\n      return promise;\n    };\n  };\n\n  return FetchStubBuilder;\n}();\n\nexport { FetchStubBuilder };\n\nvar PerformanceObserverStubBuilder =\n/** @class */\nfunction () {\n  function PerformanceObserverStubBuilder() {}\n\n  PerformanceObserverStubBuilder.prototype.getEntryTypes = function () {\n    // tslint:disable-next-line: no-unsafe-any\n    return this.instance.entryTypes;\n  };\n\n  PerformanceObserverStubBuilder.prototype.fakeEntry = function (entry, entryType) {\n    var asEntryList = function () {\n      return [entry];\n    }; // tslint:disable-next-line: no-unsafe-any\n\n\n    this.instance.callback({\n      getEntries: asEntryList,\n      getEntriesByName: asEntryList,\n      getEntriesByType: function (type) {\n        if (type === entryType) {\n          return asEntryList();\n        }\n\n        return [];\n      }\n    });\n  };\n\n  PerformanceObserverStubBuilder.prototype.getStub = function () {\n    var _a; // tslint:disable-next-line:no-this-assignment\n\n\n    var builder = this;\n    return _a =\n    /** @class */\n    function () {\n      function class_1(callback) {\n        this.callback = callback;\n        builder.instance = this;\n      }\n\n      class_1.prototype.observe = function (options) {\n        if (options) {\n          // tslint:disable-next-line: no-unsafe-any\n          builder.instance.entryTypes = options.entryTypes;\n        }\n      };\n\n      return class_1;\n    }(), _a.supportedEntryTypes = ['navigation'], _a;\n  };\n\n  return PerformanceObserverStubBuilder;\n}();\n\nexport { PerformanceObserverStubBuilder };\nexport function setPageVisibility(visibility) {\n  Object.defineProperty(document, 'visibilityState', {\n    get: function () {\n      return visibility;\n    },\n    configurable: true\n  });\n}\nexport function restorePageVisibility() {\n  delete document.visibilityState;\n}","map":{"version":3,"sources":["../src/specHelper.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __awaiter, __generator } from \"tslib\";\nimport { noop } from './utils';\nexport var SPEC_ENDPOINTS = {\n    internalMonitoringEndpoint: 'https://monitoring-intake.com/abcde?foo=bar',\n    logsEndpoint: 'https://logs-intake.com/abcde?foo=bar',\n    rumEndpoint: 'https://rum-intake.com/abcde?foo=bar',\n    traceEndpoint: 'https://trace-intake.com/abcde?foo=bar',\n};\nexport function isSafari() {\n    return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n}\nexport function isFirefox() {\n    return navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n}\nexport function isIE() {\n    return navigator.userAgent.indexOf('MSIE ') > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./);\n}\nexport function clearAllCookies() {\n    document.cookie.split(';').forEach(function (c) {\n        document.cookie = c.replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n    });\n}\nvar FetchStubBuilder = /** @class */ (function () {\n    function FetchStubBuilder(_a) {\n        var _this = this;\n        var requestStartObservable = _a[0], requestCompleteObservable = _a[1];\n        this.requests = [];\n        this.whenAllCompleteFn = noop;\n        var pendingFetch = 0;\n        requestStartObservable.subscribe(function () {\n            pendingFetch += 1;\n        });\n        requestCompleteObservable.subscribe(function (request) {\n            _this.requests.push(request);\n            pendingFetch -= 1;\n            if (pendingFetch === 0) {\n                // ensure that AssertionError are not swallowed by promise context\n                setTimeout(function () {\n                    _this.whenAllCompleteFn(_this.requests);\n                });\n            }\n        });\n    }\n    FetchStubBuilder.prototype.whenAllComplete = function (onCompleteFn) {\n        this.whenAllCompleteFn = onCompleteFn;\n    };\n    FetchStubBuilder.prototype.getStub = function () {\n        var _this = this;\n        return (function () {\n            var resolve;\n            var reject;\n            var promise = new Promise(function (res, rej) {\n                resolve = res;\n                reject = rej;\n            });\n            promise.resolveWith = function (response) { return __awaiter(_this, void 0, void 0, function () {\n                var _this = this;\n                return __generator(this, function (_a) {\n                    return [2 /*return*/, resolve(__assign(__assign({}, response), { clone: function () {\n                                var cloned = {\n                                    text: function () { return __awaiter(_this, void 0, void 0, function () {\n                                        return __generator(this, function (_a) {\n                                            if (response.responseTextError) {\n                                                throw response.responseTextError;\n                                            }\n                                            return [2 /*return*/, response.responseText];\n                                        });\n                                    }); },\n                                };\n                                return cloned;\n                            } }))];\n                });\n            }); };\n            promise.rejectWith = function (error) { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\n                return [2 /*return*/, reject(error)];\n            }); }); };\n            return promise;\n        });\n    };\n    return FetchStubBuilder;\n}());\nexport { FetchStubBuilder };\nvar PerformanceObserverStubBuilder = /** @class */ (function () {\n    function PerformanceObserverStubBuilder() {\n    }\n    PerformanceObserverStubBuilder.prototype.getEntryTypes = function () {\n        // tslint:disable-next-line: no-unsafe-any\n        return this.instance.entryTypes;\n    };\n    PerformanceObserverStubBuilder.prototype.fakeEntry = function (entry, entryType) {\n        var asEntryList = function () { return [entry]; };\n        // tslint:disable-next-line: no-unsafe-any\n        this.instance.callback({\n            getEntries: asEntryList,\n            getEntriesByName: asEntryList,\n            getEntriesByType: function (type) {\n                if (type === entryType) {\n                    return asEntryList();\n                }\n                return [];\n            },\n        });\n    };\n    PerformanceObserverStubBuilder.prototype.getStub = function () {\n        var _a;\n        // tslint:disable-next-line:no-this-assignment\n        var builder = this;\n        return _a = /** @class */ (function () {\n                function class_1(callback) {\n                    this.callback = callback;\n                    builder.instance = this;\n                }\n                class_1.prototype.observe = function (options) {\n                    if (options) {\n                        // tslint:disable-next-line: no-unsafe-any\n                        builder.instance.entryTypes = options.entryTypes;\n                    }\n                };\n                return class_1;\n            }()),\n            _a.supportedEntryTypes = ['navigation'],\n            _a;\n    };\n    return PerformanceObserverStubBuilder;\n}());\nexport { PerformanceObserverStubBuilder };\nexport function setPageVisibility(visibility) {\n    Object.defineProperty(document, 'visibilityState', {\n        get: function () {\n            return visibility;\n        },\n        configurable: true,\n    });\n}\nexport function restorePageVisibility() {\n    delete document.visibilityState;\n}\n//# sourceMappingURL=specHelper.js.map"]},"metadata":{},"sourceType":"module"}