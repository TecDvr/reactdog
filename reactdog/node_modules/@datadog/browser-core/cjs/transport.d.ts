import { Context } from './utils';
/**
 * Use POST request without content type to:
 * - avoid CORS preflight requests
 * - allow usage of sendBeacon
 *
 * multiple elements are sent separated by \n in order
 * to be parsed correctly without content type header
 */
export declare class HttpRequest {
    private endpointUrl;
    private bytesLimit;
    private withBatchTime;
    constructor(endpointUrl: string, bytesLimit: number, withBatchTime?: boolean);
    send(data: string, size: number): void;
}
export declare class Batch<T> {
    private request;
    private maxSize;
    private bytesLimit;
    private maxMessageSize;
    private flushTimeout;
    private contextProvider;
    private beforeUnloadCallback;
    private pushOnlyBuffer;
    private upsertBuffer;
    private bufferBytesSize;
    private bufferMessageCount;
    constructor(request: HttpRequest, maxSize: number, bytesLimit: number, maxMessageSize: number, flushTimeout: number, contextProvider: () => Context, beforeUnloadCallback?: () => void);
    add(message: T): void;
    upsert(message: T, key: string): void;
    flush(): void;
    private addOrUpdate;
    private process;
    private push;
    private remove;
    private hasMessageFor;
    private willReachedBytesLimitWith;
    private isFull;
    private sizeInBytes;
    private flushPeriodically;
    private flushOnVisibilityHidden;
}
